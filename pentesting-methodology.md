# Pentesting methodology

### 1. Service discovery / Port scan

```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP> 

# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP> 

# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

# Bettercap2 Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```


### 2. Application scan

1. Make sure you use updated tools. 
2. It's a good idea to use multiple tools if possible. 

#### Tools 
1. [Nikto](https://cdn.comparitech.com/wp-content/uploads/2019/07/NIkto-Cheat-Sheet.pdf) - Web server scanner
2. [Dirbuster / dirb](https://www.kali.org/tools/dirb/) - Enumerate directories
3. [Wpscan](https://github.com/wpscanteam/wpscan/wiki/WPScan-User-Documentation) - Wordpress scanner
4. [sqlmap](https://www.security-sleuth.com/sleuth-blog/2017/1/3/sqlmap-cheat-sheet) - Automatic SQL injection and database takeover tool


[See more info and other ways here ðŸ‘‰](https://book.hacktricks.xyz/generic-methodologies-and-resources/pentesting-network#scanning-hosts)



### 2. Search for known vulnerabilities

1. Identify, learn about and prioritise the vulnerabilities from step 1. 
2. See if searchsploit has a script for the vulnerability that could be useful.
3. **Understand what the script is doing before running it!!**

Searchsploit examples

```bash
#Searchsploit tricks
searchsploit "linux Kernel" #Example
searchsploit apache mod_ssl #Other example
searchsploit -m 7618 #Paste the exploit in current directory
searchsploit -p 7618[.c] #Show complete path
searchsploit -x 7618[.c] #Open vi to inspect the exploit
searchsploit --nmap file.xml #Search vulns inside an nmap xml result
```

See more info and other ways ðŸ‘‰ https://book.hacktricks.xyz/generic-methodologies-and-resources/search-exploits


## Other tools
- [Responder](https://www.ivoidwarranties.tech/posts/pentesting-tuts/responder/cheatsheet/) - Windows network MiTM / poisoning. LLMNR, NBT-NS and MDNS poisoning
- 
